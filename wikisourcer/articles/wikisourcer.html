<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to wikisourcer • wikisourcer</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to wikisourcer">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">wikisourcer</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/wikisourcer.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Functions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/wikisource_book.html">Wikisource_book</a>
    </li>
    <li>
      <a href="../reference/wikisource_page.html">Wikisource_page</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://twitter.com/lgnbhl">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/lgnbhl/wikisourcer">
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="http://felixluginbuhl.com">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to wikisourcer</h1>
                        <h4 class="author">Félix Luginbühl</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lgnbhl/wikisourcer/blob/master/vignettes/wikisourcer.Rmd"><code>vignettes/wikisourcer.Rmd</code></a></small>
      <div class="hidden name"><code>wikisourcer.Rmd</code></div>

    </div>

    
    
<p>The digital library <a href="https://wikisource.org/">Wikisource</a>, a sister projet of <em>Wikipedia</em>, hosts books in the public domain in almost all languages. More than 100’000 books are accessible in English, Spanish, French, German, Russian or Chinese.</p>
<p>The <strong>wikisourcer</strong> R package helps you download any book or page from Wikisource. The text is downloaded in a tidy dataframe, so it can be analyzed within the tidyverse ecosystem as explained for example in the book <em><a href="https://www.tidytextmining.com">Text mining with R</a></em>.</p>
<div id="download-books" class="section level2">
<h2 class="hasAnchor">
<a href="#download-books" class="anchor"></a>Download books</h2>
<p>To download Voltaire’s philosophical novel <em>Candide</em>, simply paste the url of the table of content into the <code>wikisource_book</code> function. Note that the book is already classified by chapter with the <code>page</code> variable.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(wikisourcer)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="../reference/wikisource_book.html">wikisource_book</a></span>(<span class="dt">url =</span> <span class="st">"https://en.wikisource.org/wiki/Candide"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 864 x 5
##    text                           page language url                   title
##    &lt;chr&gt;                         &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;                 &lt;chr&gt;
##  1 ""                                1 en       https://en.wikisourc… Cand…
##  2 In the country of Westphalia…     1 en       https://en.wikisourc… Cand…
##  3 "The Baron was one of the mo…     1 en       https://en.wikisourc… Cand…
##  4 My Lady Baroness, who weighe…     1 en       https://en.wikisourc… Cand…
##  5 Master Pangloss taught the m…     1 en       https://en.wikisourc… Cand…
##  6 "\"It is demonstrable,\" sai…     1 en       https://en.wikisourc… Cand…
##  7 Candide listened attentively…     1 en       https://en.wikisourc… Cand…
##  8 One day when Miss Cunegund w…     1 en       https://en.wikisourc… Cand…
##  9 On her way back she happened…     1 en       https://en.wikisourc… Cand…
## 10 ""                                1 en       https://en.wikisourc… Cand…
## # … with 854 more rows</code></pre>
<p>Multiple books can easily be downoaded using the <code>purrr</code> package. For example, we can download <em>Candide</em> in French, English, Spanish and Italian.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(purrr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">fr &lt;-<span class="st"> "https://fr.wikisource.org/wiki/Candide,_ou_l%E2%80%99Optimisme/Garnier_1877"</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">en &lt;-<span class="st"> "https://en.wikisource.org/wiki/Candide"</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">es &lt;-<span class="st"> "https://es.wikisource.org/wiki/C%C3%A1ndido,_o_el_optimismo"</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">it &lt;-<span class="st"> "https://it.wikisource.org/wiki/Candido"</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">urls &lt;-<span class="st"> </span><span class="kw">c</span>(fr, en, es, it)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">candide &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map.html">map_df</a></span>(urls, wikisource_book)</a></code></pre></div>
<p>Before making a text analysis, the text should be cleaned from remaining Wikisource metadata.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(stringr)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">candide_cleaned &lt;-<span class="st"> </span>candide <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(text, <span class="st">"CHAPITRE|↑"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#clean French</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(text, <span class="st">"CAPITULO"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#clean Spanish</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(text, <span class="st">"../|IncludiIntestazione|Romanzi|^</span><span class="ch">\\</span><span class="st">d+"</span>)) <span class="co">#clean Italian</span></a></code></pre></div>
<p>We can now compare the number of words in each chapter by language.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">library</span>(tidytext)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">candide_cleaned <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="st">  </span>tidytext<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidytext/topics/unnest_tokens">unnest_tokens</a></span>(word, text) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(page, language, <span class="dt">sort =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> <span class="kw">as.factor</span>(page), <span class="dt">y =</span> n, <span class="dt">fill =</span> language)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_bar">geom_col</a></span>(<span class="dt">position =</span> <span class="st">"dodge"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="st">    </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">x =</span> <span class="st">"chapter"</span>, <span class="dt">y =</span> <span class="st">"number of words"</span>,</a>
<a class="sourceLine" id="cb5-11" data-line-number="11">         <span class="dt">title =</span> <span class="st">"Multilingual Text analysis of Voltaire's Candide"</span>)</a></code></pre></div>
<p><img src="wikisourcer_files/figure-html/language_analysis-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="download-pages" class="section level2">
<h2 class="hasAnchor">
<a href="#download-pages" class="anchor"></a>Download pages</h2>
<p>The <code>wikisource_book</code> function sometimes doesn’t work. It happens when the main url path differs from the ones of the linked urls or when the function fails to identify correctly the linked urls. This issue can easily be fixed using the <code>wikisource_page</code> function.</p>
<p>The <code>wikisource_page</code> function has two arguments, i.e. the Wikisource url and an optional title for the page. For example, we can download <em>Sonnet 18</em> of William Shakespeare.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/wikisource_page.html">wikisource_page</a></span>(<span class="dt">wikiurl =</span> <span class="st">"https://en.wikisource.org/wiki/Shakespeare%27s_Sonnets/Sonnet_18"</span>, </a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                <span class="dt">page =</span> <span class="st">"Sonnet 18"</span>)</a></code></pre></div>
<pre><code>## # A tibble: 35 x 4
##    text                   page    language url                             
##    &lt;chr&gt;                  &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;                           
##  1 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  2 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  3 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  4 XVIII.                 Sonnet… en       https://en.wikisource.org/wiki/…
##  5 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  6 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  7 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  8 ""                     Sonnet… en       https://en.wikisource.org/wiki/…
##  9 Shall I compare thee … Sonnet… en       https://en.wikisource.org/wiki/…
## 10 Thou art more lovely … Sonnet… en       https://en.wikisource.org/wiki/…
## # … with 25 more rows</code></pre>
<p>The <code>wikisource_book</code> function fails to download the 154 Sonnets from the main url “<a href="https://en.wikisource.org/wiki/Shakespeare%27s_Sonnets/" class="uri">https://en.wikisource.org/wiki/Shakespeare%27s_Sonnets/</a>”. We have to use <code>wikisource_page</code> to download them.</p>
<p>Let’s begin by creating a list of the 154 wikipages we want to download, using the R base function <code>paste0</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">urls &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"https://en.wikisource.org/wiki/Shakespeare%27s_Sonnets/Sonnet_"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">154</span>)</a></code></pre></div>
<p>Now we can download all the Sonnets with <code>purrr</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">sonnets &lt;-<span class="st"> </span>purrr<span class="op">::</span><span class="kw"><a href="https://purrr.tidyverse.org/reference/map2.html">map2_df</a></span>(urls, <span class="kw">paste0</span>(<span class="st">"Sonnet "</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">154</span>), wikisource_page)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">sonnets</a></code></pre></div>
<pre><code>## # A tibble: 3,618 x 4
##    text                   page   language url                              
##    &lt;chr&gt;                  &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;                            
##  1 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
##  2 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
##  3 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
##  4 HEAD OF EROS (CUPID),… Sonne… en       https://en.wikisource.org/wiki/S…
##  5 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
##  6 "SONNETS. "            Sonne… en       https://en.wikisource.org/wiki/S…
##  7 I.                     Sonne… en       https://en.wikisource.org/wiki/S…
##  8 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
##  9 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
## 10 ""                     Sonne… en       https://en.wikisource.org/wiki/S…
## # … with 3,608 more rows</code></pre>
<p>We can make a text similarity analysis. Which sonnets are the closest to each others in terms of words used?</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">library</span>(widyr)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="kw">library</span>(SnowballC)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">library</span>(igraph)</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="kw">library</span>(ggraph)</a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">sonnets_similarity &lt;-<span class="st"> </span>sonnets <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(text, <span class="st">"public domain|Public domain"</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#clean text</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="st">  </span>tidytext<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidytext/topics/unnest_tokens">unnest_tokens</a></span>(word, text) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">anti_join</a></span>(tidytext<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidytext/topics/get_stopwords">get_stopwords</a></span>(<span class="st">"en"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">anti_join</a></span>(<span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="dt">word =</span> <span class="kw">c</span>(<span class="st">"thy"</span>, <span class="st">"thou"</span>, <span class="st">"thee"</span>))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#old English stopwords</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">wordStem =</span> SnowballC<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/SnowballC/topics/wordStem">wordStem</a></span>(word)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#Stemming</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(page, wordStem) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">  </span>widyr<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/widyr/topics/pairwise_similarity">pairwise_similarity</a></span>(page, wordStem, n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(similarity <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15"></a>
<a class="sourceLine" id="cb11-16" data-line-number="16"><span class="co"># themes by sonnet </span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17">theme &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/reexports.html">data_frame</a></span>(<span class="dt">page =</span> <span class="kw">unique</span>(sonnets<span class="op">$</span>page),</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">                    <span class="dt">theme =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">"Procreation"</span>, <span class="dt">times =</span> <span class="dv">17</span>), <span class="kw">rep</span>(<span class="st">"Fair Youth"</span>, <span class="dt">times =</span> <span class="dv">60</span>),</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">                              <span class="kw">rep</span>(<span class="st">"Rival Poet"</span>, <span class="dt">times =</span> <span class="dv">9</span>), <span class="kw">rep</span>(<span class="st">"Fair Youth"</span>, <span class="dt">times =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">                              <span class="kw">rep</span>(<span class="st">"Irregular"</span>, <span class="dt">times =</span> <span class="dv">1</span>), <span class="kw">rep</span>(<span class="st">"Fair Youth"</span>, <span class="dt">times =</span> <span class="dv">26</span>),</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">                              <span class="kw">rep</span>(<span class="st">"Irregular"</span>, <span class="dt">times =</span> <span class="dv">1</span>), <span class="kw">rep</span>(<span class="st">"Dark Lady"</span>, <span class="dt">times =</span> <span class="dv">28</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(page <span class="op">%in%</span><span class="st"> </span>sonnets_similarity<span class="op">$</span>item1 <span class="op">|</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"><span class="st">         </span>page <span class="op">%in%</span><span class="st"> </span>sonnets_similarity<span class="op">$</span>item2)</a>
<a class="sourceLine" id="cb11-24" data-line-number="24"></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb11-26" data-line-number="26"></a>
<a class="sourceLine" id="cb11-27" data-line-number="27">sonnets_similarity <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/igraph/topics/graph_from_data_frame">graph_from_data_frame</a></span>(<span class="dt">vertices =</span> theme) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-29" data-line-number="29"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/ggraph">ggraph</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geom_edge_link">geom_edge_link</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">edge_alpha =</span> similarity)) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geom_node_point">geom_node_point</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color =</span> theme), <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-32" data-line-number="32"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggraph/topics/geom_node_text">geom_node_text</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">label =</span> name), <span class="dt">size =</span> <span class="fl">3.5</span>, <span class="dt">check_overlap =</span> <span class="ot">TRUE</span>, <span class="dt">vjust =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_void</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Closest Shakespeare's Sonnets to each others in terms of words used"</span>)</a></code></pre></div>
<p><img src="wikisourcer_files/figure-html/similarity_analysis-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="tidy-text-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#tidy-text-analysis" class="anchor"></a>Tidy text analysis</h2>
<p>The <strong>wikisourcer</strong> package has been built to work within the tidyverse ecosystem. For example, we can easily make a <a href="https://www.tidytextmining.com/sentiment.html">tidy sentiment analysis</a> of any book by chapter, as the chapters are automatically created in the <code>page</code> variable.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">jane &lt;-<span class="st"> </span><span class="kw"><a href="../reference/wikisource_book.html">wikisource_book</a></span>(<span class="st">"https://en.wikisource.org/wiki/Pride_and_Prejudice"</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">jane_sent &lt;-<span class="st"> </span>jane <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidytext/topics/unnest_tokens">unnest_tokens</a></span>(word, text) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">inner_join</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/tidytext/topics/get_sentiments">get_sentiments</a></span>(<span class="st">"bing"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">anti_join</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/tidytext/topics/get_stopwords">get_stopwords</a></span>(<span class="st">"en"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/tally.html">count</a></span>(page, sentiment) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/tidyr/topics/spread">spread</a></span>(<span class="dt">key =</span> sentiment, <span class="dt">value =</span> n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">sentiment =</span> positive <span class="op">-</span><span class="st"> </span>negative)</a>
<a class="sourceLine" id="cb12-12" data-line-number="12"></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(jane_sent, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(page, sentiment)) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_bar">geom_col</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_smooth">geom_smooth</a></span>(<span class="dt">method =</span> <span class="st">"loess"</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggtheme">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">labs</a></span>(<span class="dt">title =</span> <span class="st">"Sentiment analysis of “Pride and Prejudice”"</span>,</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">       <span class="dt">subtitle =</span> <span class="st">"Positive-negative words difference, by chapter"</span>,</a>
<a class="sourceLine" id="cb12-19" data-line-number="19">       <span class="dt">x =</span> <span class="st">"chapter"</span>, <span class="dt">y =</span> <span class="st">"sentiment score"</span>)</a></code></pre></div>
<p><img src="wikisourcer_files/figure-html/sentiment_analysis-1.png" width="672" style="display: block; margin: auto;"></p>
<p>More example of text analysis can be found in the book <em><a href="https://www.tidytextmining.com">Text mining with R</a></em>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#download-books">Download books</a></li>
      <li><a href="#download-pages">Download pages</a></li>
      <li><a href="#tidy-text-analysis">Tidy text analysis</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Félix Luginbuhl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
